An open-source IDS, IPS & [[Network analysis software]]. 

Functions:
 - [[IDS (Intrusion detection system)]]:
   Can function as a [[NIDS (Network-based intrusion detection system)]] and [[HIDS (Host-based intrusion detection system)]]
 - [[IPS (Intrusion prevention system)]]:
    Running Suricata in IPS mode requires additional configuration such as enabling IPS mode
    Drop actions only work in IPS mode
 - [[Network analysis software]]:

[[signature]]s/Rules:
 Rule and signature are used interchangeably.
 Security analysts use signatures or patterns associated with malicious activity to detect and alert
 Rules can also be used to provide additional context and visibility into systems and networks to help identify potential security threats or vulnerabilities
 Suricata uses [[signature-based analysis]]

Example Suricata signatures:
 ![[Pasted image 20231224162649.png]]
 ![[Pasted image 20231224155452.png]]
 $ indicates the start of a variable
 
Suricata format type:
 - Extensible Event Format JavaScript Object Notation (EVE JSON)

Suricata log types:
 - Alert logs example
  ![[Pasted image 20231224160223.png]]
 - Network telemetry logs example
   ![[Pasted image 20231224160254.png]]

Custom rules:
 Its recommended to modify existing rules to meet your specific security requirements.
 There is no one-size-fits-all approach to creating and modifying rules because each organizations infrastructure differs. 
 Security teams must test and modify detection signatures according to their needs.
 Custom rules helps to minimize the amount of [[False positive]] alerts.
 It is important to develop the ability to write effective and customized signatures so that you can fully leverage the power of detection technologies.

[[Configuration file]]:
 Suricata's configuration file is suricata.yaml
 It is crucial to configure settings to your organizations specific needs

Log files:
 Log files that Suricata generates when alerts are triggered.
 - eve.json:
    Contains detailed information and metadata about events and alerts generated by Suricata stored in [[JavaScript Object Notation (JSON)]] format. 
   E.G. events in this file contain a unique identifier called flow_id which is used to correlate related logs or alerts to a single network flow, making it easier to analyse network traffic.  Used for detailed analysis and is used for log parsing & SIEM log ingestion
 - fast.log: 
   Used to record minimal alert information including basic IP address and port details about the network traffic. 
   Used for basic logging & alerting and is considered a legacy file format that is not suitable for incident response or threat hunting tasks.
 Main difference is the level of detail recorded in each.
 
Actions:
 - Suricata default action processing order: pass, drop, reject & alert.
 - Alert: Sends out an alert
 - Drop: Generates an alert & drops the traffic (only occurs when Suricata runs in IPS mode)
 - Pass: Allows traffic to pass through the network interface. Can be used to override other rules.
 - Reject: Doesn't allow traffic to pass & sends a [[TCP reset packet ]]

Rule Options
 - `msg`: provides the alert text 
   E.G. `msg: "GET on wire"` prints `Get on wire`
 - `flow:` specifies conditions related to the flow of network traffic 
   E.G. The `flow: established,to_server` option determines that packets from the client to the server (the device responding to the initial SYN packet with a SYN-ACK packet) should be matched  
 - `content:` tells Suricata what word to look for in the content of a portion of the packet. 
   E.G. The `content: "GET"` option tells Suricata to look for the word `GET` in the content of the `http.method` portion of the packet
 - `sid:` a unique numerical value that identifies the rule
   E.G. `sid: 12345`
 - `rev:` indicates the signatures revision which is used to identify the signatures version
   E.G. `rev: 3`
 ![[Pasted image 20231224201135.png]]

Command
 ` sudo suricata -r sample.pcap -S custom.rules -k none`
 - -r(ead) input file containing network traffic
 - -S(ignature) input file containing signature/rules
 - -K specifies [[checksum]] chec**k**s